<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Visor 360ยบ GDIE P2</title>
    <script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script>
    <script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
</head>
<body>
<!--al fer click a la esfera verda, redireccionar la web-->
<script>
    AFRAME.registerComponent('clickable', {
        init: function () {
            this.index = 0;
            this.el.addEventListener('click', e => {
                if (this.el.id === "bola1") {
                    window.location.hash = "1";
                }else{
                    console.log(this.el.id);
                    window.location.hash = "2";
                }
            });
            this.video = document.querySelector('video');
        }
    });
</script>

<!--listener hashstagechange: al canviar de hash, realitzar unes accions determinades-->
<script>
    window.addEventListener('hashchange', function (e) {
        console.log("Accions a partir del canvi de hash: "+ window.location.hash);
        switch(window.location.hash) {
            case "#1":
                console.log("case 1 del switch");
                document.getElementById("idsrc").src="https://ltim.uib.es/files/palma360/r12b/720.mp4";
                document.getElementById("bola1").setAttribute('visible','false');
                document.getElementById("bola2").setAttribute('visible','false');
                break;
            case "#2":
                console.log("case 2 del switch");
                document.getElementById("bola1").setAttribute('visible','false');
                document.getElementById("bola2").setAttribute('visible','false');
                break;
            default:
            console.log("default case del switch");
        }
    });
</script>

<a-scene inspector="" keyboard-shortcuts="" screenshot="" vr-mode-ui="">
    <a-assets>
        <video data-dashjs-player id="idsrc" autoplay crossorigin loop muted
               src="https://ltim.uib.es/files/palma360/p10/720.mp4"></video>
    </a-assets>
    <a-videosphere rotation="0 -90 0" src="#idsrc"></a-videosphere>
    <a-sphere id="bola2" class="clickable" color="red" radius="1.5" position="45 1.6 0"clickable ></a-sphere>
    <a-sphere id="bola1" class="clickable" color="green" radius="1.2" position="0 2 -20" clickable></a-sphere>
    <a-entity camera="" look-controls="" position="0 1.6 0" rotation="">
        <a-entity cursor="" position="0 0 -1" geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                  material="color: black; shader: flat" raycaster="">
        </a-entity>
    </a-entity>
    <canvas class="a-canvas a-grab-cursor" data-aframe-canvas="true" width="1366" height="635" style=""></canvas>
    <div class="a-loader-title" style="display: none;">GDIE 360ยบ</div>
</body>

</html>